
////////////////////////////////////////////////////////////////////////////////
//
// Функция ДоступнаКомпонентаОбменаИПодписания
//
// Описание:
//  проверяет на стороне клиента загружена ли компонента обмена и подписания
//
// Параметры (название, тип, дифференцированное значение)
//  РежимРаботы - Число(1,0) - режим работы (0 - на клиенте, 1 - на сервере)
//
// Возвращаемое значение:
//  Булево - результат проверки
//
Функция ДоступнаКомпонентаОбменаИПодписания(РежимРаботы) Экспорт

	Если РежимРаботы = 0 Тогда
		Возврат EInvVatService <> Неопределено;
	ИначеЕсли РежимРаботы = 2 Тогда // если режим проведения "Отложенный", то компонента не требуется
		Возврат Истина;
	Иначе
		Возврат ЭСЧФсервер.ДоступнаКомпонентаОбменаИПодписания();
	КонецЕсли;

КонецФункции //ДоступнаКомпонентаОбменаИПодписания

////////////////////////////////////////////////////////////////////////////////
//
// Функция ДоступнаВыгрузкаДокументовВФайлы
//
// Описание:
//  проверяет на стороне клиента возможность выгрузки документов во внешние файлы
//
//
// Параметры (название, тип, дифференцированное значение)
//  РежимРаботы - Число(1,0) - режим работы (0 - на клиенте, 1 - на сервере)
//
// Возвращаемое значение:
//  Булево - результат проверки
//
Функция ДоступнаВыгрузкаДокументовВФайлы(РежимРаботы) Экспорт

	Если РежимРаботы = 0 Тогда
		
		Если Не РольДоступна("ИспользованиеЭСЧФ") И Не РольДоступна("ИспользованиеЭСЧФПолный") Тогда
			Возврат Ложь;
		КонецЕсли;
		
		Каталог = Новый Файл(ПараметрыСеанса.XSD);
		Возврат Каталог.Существует() И Каталог.ЭтоКаталог();
		
	ИначеЕсли РежимРаботы = 1 Тогда
		
		Возврат ЭСЧФсервер.ДоступнаВыгрузкаДокументовВФайлы();
		
	Иначе
		
		Возврат РольДоступна("ПолныеПрава") Или РольДоступна("ИспользованиеЭСЧФ") Или РольДоступна("ИспользованиеЭСЧФПолный");
		
	КонецЕсли;

КонецФункции //ДоступнаВыгрузкаДокументовВФайлы

// Возвращает массив типов документов, которые не нужно обрабатывать
//
// Возвращаемое значение:
//   Массив   - типы документов, которые не нужно обрабатывать (загружаются авто.)
//
Функция ТипыДокументовРеализацииНеОбрабатывать() Экспорт
	Возврат ЭСЧФобщий.ТипыДокументовРеализацииНеОбрабатывать()
КонецФункции

////////////////////////////////////////////////////////////////////////////////
//
// Функция ПолучитьКомпонентыДоступаКПорталуЭСФЧ
//
// Описание:
//  возвращаем COM-объект для работы с порталом
//
//
// Параметры (название, тип, дифференцированное значение)
//
// Возвращаемое значение:
//  COMОбъект("EInvVatService.Connector") - объект для работы с порталом
//
Функция ПолучитьКомпонентыДоступаКПорталуЭСФЧ() Экспорт

	Попытка
		EInvVatService = Новый COMОбъект("EInvVatService.Connector");
	Исключение
		EInvVatService = Неопределено;
		Сообщение = Новый СообщениеПользователю;
		Сообщение.Текст = "На компьютере не обнаружены компоненты, необходимые для доступа к порталу ЭСФЧ";
		Сообщение.Сообщить();
	КонецПопытки;
	
	Возврат EInvVatService

КонецФункции //ПолучитьКомпонентыДоступаКПорталуЭСФЧ

